# ü§ñ Archbase CLI + Claude Code - Guia de Integra√ß√£o

## üéØ **Vis√£o Geral da Integra√ß√£o**

A integra√ß√£o entre Archbase CLI e Claude Code resolve o problema fundamental: **Claude Code n√£o conhece bibliotecas customizadas**. O CLI atua como uma "ponte de conhecimento" que fornece contexto estruturado sobre os componentes Archbase para a IA.

---

## üîÑ **Fluxo de Trabalho Integrado**

### **1. Desenvolvedor ‚Üí Claude Code ‚Üí CLI ‚Üí C√≥digo**

```mermaid
graph LR
    A[üë®‚Äçüíª Desenvolvedor] --> B[ü§ñ Claude Code]
    B --> C[‚ö° Archbase CLI]
    C --> D[üìö Knowledge Base]
    D --> C
    C --> B
    B --> E[üíª C√≥digo Gerado]
```

### **Passo a Passo:**
1. **Desenvolvedor** faz pergunta para Claude Code
2. **Claude Code** consulta o Archbase CLI para obter contexto
3. **CLI** retorna informa√ß√µes estruturadas sobre componentes
4. **Claude Code** usa esse contexto para gerar c√≥digo inteligente
5. **C√≥digo** √© gerado seguindo padr√µes Archbase automaticamente

---

## üí¨ **Exemplos Pr√°ticos de Conversas**

### **üéØ Cen√°rio 1: Criando um Formul√°rio de Usu√°rio**

#### **Conversa com Claude Code:**
```
üë®‚Äçüíª Desenvolvedor: "Preciso criar um formul√°rio de cadastro de usu√°rio com nome, email e telefone usando Archbase React V3"

ü§ñ Claude Code: "Vou consultar o CLI para obter informa√ß√µes sobre os componentes de formul√°rio do Archbase..."

[Claude executa internamente: archbase query component ArchbaseFormTemplate]
[Claude executa internamente: archbase query component ArchbaseEdit]

ü§ñ Claude Code: "Baseado no conhecimento do Archbase V3, vou criar um formul√°rio usando ArchbaseFormTemplate com DataSource V2. Aqui est√° o c√≥digo:"

```typescript
import React, { useCallback } from 'react';
import { 
  useArchbaseRemoteDataSource
} from '@archbase/data';
import {
  ArchbaseEdit
} from '@archbase/components';
import {
  ArchbaseFormTemplate
} from '@archbase/template';
import { UserDto } from '../domain/UserDto';
import { UserRemoteService } from '../service/UserRemoteService';

interface UserFormProps {
  userId?: string;
}

export function UserForm({ userId }: UserFormProps) {
  const { dataSource, isLoading, error } = useArchbaseRemoteDataSource<UserDto, string>({
    name: 'dsUser',
    label: 'User',
    service: UserRemoteService,
    pageSize: 50,
    loadOnStart: true,
    id: userId,
  });

  const handleAfterSave = useCallback((entity: UserDto) => {
    // Navigate back to list view
  }, []);

  if (isLoading) return <div>Carregando...</div>;
  if (error) return <div>Erro: {error.message}</div>;

  return (
    <ArchbaseFormTemplate
      title="Cadastro de Usu√°rio"
      dataSource={dataSource}
      onAfterSave={handleAfterSave}
    >
      <ArchbaseEdit
        label="Nome"
        dataSource={dataSource}
        dataField="name"
        required
        placeholder="Digite o nome completo"
      />
      
      <ArchbaseEdit
        label="E-mail"
        dataSource={dataSource}
        dataField="email"
        type="email"
        required
        placeholder="usuario@exemplo.com"
      />
      
      <ArchbaseEdit
        label="Telefone"
        dataSource={dataSource}
        dataField="phone"
        placeholder="(11) 99999-9999"
      />
    </ArchbaseFormTemplate>
  );
}
```

üë®‚Äçüíª Desenvolvedor: "Perfeito! Como adiciono valida√ß√£o a este formul√°rio?"

ü§ñ Claude Code: "Vou consultar as op√ß√µes de valida√ß√£o dispon√≠veis..."

[Claude executa: archbase query component ArchbaseValidator]

ü§ñ Claude Code: "Adicione valida√ß√£o usando yup. Aqui est√° a vers√£o atualizada:"

```typescript
import * as yup from 'yup';

const validator = yup.object({
  name: yup.string().required('Nome √© obrigat√≥rio'),
  email: yup.string().email('E-mail inv√°lido').required('E-mail √© obrigat√≥rio'),
  phone: yup.string().matches(/^\(\d{2}\) \d{4,5}-\d{4}$/, 'Formato inv√°lido')
});

// Adicione ao useArchbaseRemoteDataSource:
const { dataSource, isLoading, error } = useArchbaseRemoteDataSource<UserDto, string>({
  name: 'dsUser',
  label: 'User',
  service: UserRemoteService,
  validator, // ‚Üê Adicione aqui
  pageSize: 50,
  loadOnStart: true,
  id: userId,
});
```
```

---

### **üéØ Cen√°rio 2: Criando uma Lista CRUD**

#### **Conversa com Claude Code:**
```
üë®‚Äçüíª Desenvolvedor: "Agora preciso de uma lista para gerenciar esses usu√°rios, com funcionalidades de CRUD e filtros"

ü§ñ Claude Code: "Vou consultar os componentes de grid dispon√≠veis..."

[Claude executa: archbase query component ArchbaseDataGrid]
[Claude executa: archbase query component ArchbaseDataGridColumn]

ü§ñ Claude Code: "Baseado no padr√£o powerview-admin do Archbase, aqui est√° uma lista CRUD completa:"

```typescript
import React, { useMemo, useRef, useState, useCallback } from 'react';
import { 
  Paper, Group, Button, ActionIcon 
} from '@mantine/core';
import {
  IconPlus, IconEdit, IconTrash, IconEye
} from '@tabler/icons-react';
import {
  ArchbaseDataGrid,
  ArchbaseDataGridColumn,
  Columns
} from '@archbase/components';
import {
  useArchbaseRemoteDataSource
} from '@archbase/data';
import {
  useArchbaseNavigateParams,
  useArchbaseGetLoggedUser
} from '@archbase/core';

export function UserListView() {
  const loggedUser = useArchbaseGetLoggedUser();
  const navigate = useArchbaseNavigateParams();
  const gridRef = useRef<any>(null);

  const { dataSource, isLoading, error } = useArchbaseRemoteDataSource<UserDto, string>({
    name: 'dsUserList',
    service: UserRemoteService,
    pageSize: 25,
    loadOnStart: true,
  });

  const handleAdd = useCallback(() => {
    navigate('/users/new');
  }, [navigate]);

  const handleEdit = useCallback(() => {
    const record = dataSource.getCurrentRecord();
    if (record) {
      navigate(`/users/${record.id}`);
    }
  }, [dataSource, navigate]);

  const buildRowActions = useCallback((row: UserDto) => {
    return (
      <Group gap={4} wrap="nowrap">
        <ActionIcon variant="transparent" color="blue" onClick={() => {
          dataSource.gotoRecordByData(row);
          handleEdit();
        }}>
          <IconEdit size={20} />
        </ActionIcon>
        <ActionIcon variant="transparent" color="red" onClick={() => {
          dataSource.gotoRecordByData(row);
          // handleDelete logic
        }}>
          <IconTrash size={20} />
        </ActionIcon>
      </Group>
    );
  }, [dataSource, handleEdit]);

  const columns = useMemo(() => (
    <Columns>
      <ArchbaseDataGridColumn
        dataField="name"
        header="Nome"
        inputFilterType="text"
        size={200}
      />
      <ArchbaseDataGridColumn
        dataField="email"
        header="E-mail"
        inputFilterType="text"
        size={250}
      />
      <ArchbaseDataGridColumn
        dataField="phone"
        header="Telefone"
        size={150}
      />
      <ArchbaseDataGridColumn
        dataField="createdAt"
        header="Criado em"
        dataType="datetime"
        size={150}
      />
    </Columns>
  ), []);

  return (
    <Paper>
      <ArchbaseDataGrid<UserDto, string>
        gridRef={gridRef}
        dataSource={dataSource}
        isLoading={isLoading}
        enableRowActions={true}
        enableGlobalFilter={true}
        pageSize={25}
        toolbarLeftContent={
          <Group>
            <Button leftSection={<IconPlus />} onClick={handleAdd}>
              Novo Usu√°rio
            </Button>
            <Button leftSection={<IconEdit />} onClick={handleEdit}>
              Editar
            </Button>
          </Group>
        }
        renderRowActions={buildRowActions}
      >
        {columns}
      </ArchbaseDataGrid>
    </Paper>
  );
}
```
```

---

### **üéØ Cen√°rio 3: Layout Admin Completo**

#### **Conversa com Claude Code:**
```
üë®‚Äçüíª Desenvolvedor: "Como integro isso em um layout admin com navega√ß√£o e autentica√ß√£o?"

ü§ñ Claude Code: "Vou consultar os componentes de layout admin..."

[Claude executa: archbase query component ArchbaseAdminMainLayout]
[Claude executa: archbase query component ArchbaseLogin]
[Claude executa: archbase query component ArchbaseNavigationProvider]

ü§ñ Claude Code: "Aqui est√° uma estrutura completa de admin seguindo os padr√µes Archbase:"

```typescript
import React, { useState } from 'react';
import {
  ArchbaseGlobalProvider,
  ArchbaseAppProvider
} from '@archbase/core';
import {
  ArchbaseAdminMainLayout,
  ArchbaseAdminTabContainer,
  ArchbaseNavigationProvider
} from '@archbase/admin';
import {
  ArchbaseLogin,
  useArchbaseAuthenticationManager
} from '@archbase/security';

const navigationData = [
  {
    id: 'users',
    text: 'Usu√°rios',
    icon: 'IconUsers',
    route: '/users',
    children: [
      { id: 'user-list', text: 'Lista', route: '/users' },
      { id: 'user-new', text: 'Novo', route: '/users/new' }
    ]
  },
  // ... outras rotas
];

export function AdminApp() {
  const [currentUser, setCurrentUser] = useState(undefined);
  
  const { isAuthenticated, login, logout } = useArchbaseAuthenticationManager({});

  if (!isAuthenticated) {
    return (
      <ArchbaseLogin
        onLogin={(credentials) => login(credentials.username, credentials.password)}
        title="Sistema Admin"
        subtitle="Fa√ßa login para continuar"
      />
    );
  }

  return (
    <ArchbaseGlobalProvider>
      <ArchbaseAppProvider user={currentUser}>
        <ArchbaseNavigationProvider navigationData={navigationData}>
          <ArchbaseAdminMainLayout
            navigationData={navigationData}
            sideBarWidth="280px"
            enableSecurity={true}
          >
            <ArchbaseAdminTabContainer
              navigationData={navigationData}
              // Aqui v√£o as rotas com os componentes UserForm/UserListView
            />
          </ArchbaseAdminMainLayout>
        </ArchbaseNavigationProvider>
      </ArchbaseAppProvider>
    </ArchbaseGlobalProvider>
  );
}
```
```

---

## üîß **Como Claude Code Obt√©m o Contexto**

### **1. Consulta Autom√°tica via CLI**
```typescript
// Claude Code executa internamente:
const componentInfo = await execCommand('archbase query component ArchbaseEdit');

// Retorna contexto estruturado:
{
  name: "ArchbaseEdit",
  description: "Form input editor with data binding", 
  category: "editor",
  package: "@archbase/components",
  props: {
    dataSource: { type: "ArchbaseDataSource<T, ID>", required: false },
    dataField: { type: "string", required: false },
    // ...
  },
  examples: [...],
  aiHints: [
    "Always include onChangeValue handler for external state updates",
    "Use dataSource for automatic data binding"
  ],
  relatedComponents: ["ArchbaseTextArea", "ArchbasePasswordEdit"]
}
```

### **2. Knowledge Base em Mem√≥ria**
```typescript
// Claude Code carrega conhecimento do arquivo
const knowledgeBase = await loadArchbaseKnowledge();

// Acesso r√°pido a todos os 149 componentes
const allComponents = knowledgeBase.components;
const patterns = knowledgeBase.patterns;
const examples = knowledgeBase.examples;
```

### **3. Busca Inteligente**
```typescript
// Claude pode buscar por categoria
const formComponents = await searchComponents({ category: "editor" });
const adminComponents = await searchComponents({ category: "admin" });

// Ou por funcionalidade
const results = await freeSearch("data grid with pagination");
```

---

## üé® **Padr√µes de C√≥digo Autom√°ticos**

### **üìã Padr√µes que Claude Code Aprende:**

#### **1. Imports Organizados V3**
```typescript
// Claude sempre gera imports corretos:
import { useArchbaseRemoteDataSource } from '@archbase/data';
import { ArchbaseEdit, ArchbaseSelect } from '@archbase/components';
import { ArchbaseFormTemplate } from '@archbase/template';
```

#### **2. DataSource V2 Pattern**
```typescript
// Claude conhece o padr√£o powerview-admin:
const { dataSource, isLoading, error } = useArchbaseRemoteDataSource<EntityDto, string>({
  name: 'dsEntity',
  service: EntityRemoteService,
  pageSize: 50,
  loadOnStart: true,
  validator,
});
```

#### **3. Error Handling Consistente**
```typescript
// Claude adiciona automaticamente:
if (isLoading) return <div>Carregando...</div>;
if (error) return <div>Erro: {error.message}</div>;
```

#### **4. Navega√ß√£o Admin Pattern**
```typescript
// Claude conhece o padr√£o de navega√ß√£o:
const navigate = useArchbaseNavigateParams();
const handleEdit = () => navigate(`/entity/${record.id}`, {}, { action: 'EDIT' });
```

---

## üöÄ **Cen√°rios Avan√ßados**

### **üéØ Dashboard com Gr√°ficos**
```
üë®‚Äçüíª "Preciso de um dashboard com gr√°ficos de vendas"

ü§ñ Claude Code: [consulta components de chart e dashboard]

ü§ñ "Vou criar um dashboard usando ArchbaseChart e ArchbaseSpace para layout..."
```

### **üéØ Sistema de Permiss√µes**
```
üë®‚Äçüíª "Como implemento controle de acesso por permiss√µes?"

ü§ñ Claude Code: [consulta ArchbaseSecurityManager e related]

ü§ñ "Vou implementar usando ArchbaseSecurityManager com hooks de permiss√£o..."
```

### **üéØ Formul√°rios Din√¢micos**
```
üë®‚Äçüíª "Preciso de um formul√°rio que muda campos baseado em uma sele√ß√£o"

ü§ñ Claude Code: [consulta conditional rendering patterns]

ü§ñ "Vou usar ArchbaseFormTemplate com renderiza√ß√£o condicional baseada no dataSource..."
```

---

## üìà **Benef√≠cios da Integra√ß√£o**

### **‚úÖ Para Desenvolvedores:**
- **Zero curva de aprendizado** - Claude conhece todos os componentes
- **C√≥digo consistente** - Sempre segue padr√µes Archbase
- **Imports corretos** - Nunca erro de depend√™ncia V3
- **Best practices** - AI hints autom√°ticos aplicados

### **‚úÖ Para Equipe:**
- **Onboarding r√°pido** - Novos devs produtivos imediatamente
- **Qualidade consistente** - Mesmo padr√£o em todo c√≥digo
- **Documenta√ß√£o viva** - CLI sempre atualizado com V3
- **Produtividade 10x** - IA que realmente conhece a stack

### **‚úÖ Para Arquitetura:**
- **Padr√µes enfor√ßados** - Imposs√≠vel fugir dos padr√µes estabelecidos
- **Evolu√ß√£o controlada** - Atualiza√ß√µes via CLI refletem imediatamente
- **Knowledge centralizado** - Single source of truth sobre componentes
- **Escalabilidade** - Novos componentes automaticamente dispon√≠veis

---

## ü§ñ **Exemplo de Prompt Avan√ßado**

```markdown
üë®‚Äçüíª Prompt para Claude Code:

"Usando Archbase React V3, crie um sistema completo de e-commerce admin com:

1. P√°gina de login com autentica√ß√£o
2. Dashboard principal com m√©tricas
3. CRUD de produtos com upload de imagem
4. Lista de pedidos com filtros avan√ßados
5. Relat√≥rios com gr√°ficos
6. Sistema de permiss√µes por usu√°rio

Use os padr√µes powerview-admin e DataSource V2."

ü§ñ Claude Code Response:

"Vou criar um sistema completo seguindo os padr√µes Archbase V3. 
Primeiro, vou consultar os componentes necess√°rios..."

[Executa m√∫ltiplas consultas via CLI]
[Gera c√≥digo estruturado usando todos os padr√µes]
[Aplica best practices automaticamente]
[Cria imports organizados por pacote]
[Segue conven√ß√µes estabelecidas]

"Aqui est√° o sistema completo com 15+ arquivos organizados..."
```

---

## üéØ **Resultado Final**

A integra√ß√£o Archbase CLI + Claude Code cria um **desenvolvimento assistido por IA verdadeiramente inteligente**, onde:

- ‚úÖ **Claude conhece todos os 149 componentes** V3
- ‚úÖ **Gera c√≥digo seguindo padr√µes** estabelecidos  
- ‚úÖ **Imports sempre corretos** por pacote
- ‚úÖ **Zero configura√ß√£o** ou documenta√ß√£o manual
- ‚úÖ **Evolu√ß√£o autom√°tica** com atualiza√ß√µes do CLI
- ‚úÖ **Produtividade exponencial** para toda equipe

**√â como ter um arquiteto s√™nior Archbase trabalhando 24/7 com cada desenvolvedor!** üöÄ